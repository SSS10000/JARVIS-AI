<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Realtime Data Share</title>

  <!-- Firebase v8 -->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

  <!-- Tailwind CSS -->
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <!-- Animate.css -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" rel="stylesheet"/>
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&family=Poppins:wght@400;600&display=swap" rel="stylesheet">

  <style>
    body { font-family: 'Poppins', sans-serif; }
    h1, h2 { font-family: 'Orbitron', sans-serif; }
    .glow-btn { 
      transition: all 0.3s ease-in-out; 
      box-shadow: 0 0 15px rgba(255,255,255,0.4);
    }
    .glow-btn:hover { 
      transform: scale(1.05); 
      box-shadow: 0 0 25px rgba(255,255,255,0.8); 
    }
    /* Toast notification */
    #toast {
      position: fixed;
      top: 20px;
      right: 20px;
      background: linear-gradient(135deg,#6EE7B7,#3B82F6);
      color: white;
      padding: 14px 20px;
      border-radius: 12px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.2);
      display: none;
      z-index: 9999;
      animation: slideIn 0.5s ease;
    }
    @keyframes slideIn {
      from { opacity: 0; transform: translateX(100px); }
      to { opacity: 1; transform: translateX(0); }
    }
  </style>
</head>
<body class="bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500 min-h-screen flex items-center justify-center p-6">

  <div class="backdrop-blur-lg bg-white/20 shadow-2xl rounded-3xl w-full max-w-5xl p-10 animate__animated animate__fadeIn">
    <h1 class="text-5xl font-extrabold text-center text-white drop-shadow mb-12 tracking-wider">‚ö° Realtime Data Share</h1>

    <div class="grid md:grid-cols-2 gap-10">

      <!-- Sender Section -->
      <div class="p-6 rounded-2xl bg-white/60 shadow-lg hover:shadow-2xl transition transform hover:-translate-y-1">
        <h2 class="text-2xl font-bold text-purple-800 mb-5 flex items-center gap-2">üì§ Sender</h2>
        <input type="text" id="senderId" placeholder="Enter Custom ID (or leave blank)" class="w-full border rounded-lg p-3 mb-4 focus:ring-2 focus:ring-purple-500">
        <input type="file" id="fileInput" class="w-full mb-4 text-gray-700">
        <button onclick="sendData()" class="glow-btn w-full bg-purple-600 hover:bg-purple-700 text-white py-3 rounded-lg font-semibold transition animate__animated animate__pulse animate__infinite">üöÄ Send</button>
        <p id="sendStatus" class="mt-4 text-sm text-gray-800"></p>
      </div>

      <!-- Receiver Section -->
      <div class="p-6 rounded-2xl bg-white/60 shadow-lg hover:shadow-2xl transition transform hover:-translate-y-1">
        <h2 class="text-2xl font-bold text-green-800 mb-5 flex items-center gap-2">üì• Receiver</h2>
        <input type="text" id="receiverId" placeholder="Enter ID to Receive" class="w-full border rounded-lg p-3 mb-4 focus:ring-2 focus:ring-green-500">
        <button onclick="receiveData()" class="glow-btn w-full bg-green-600 hover:bg-green-700 text-white py-3 rounded-lg font-semibold transition animate__animated animate__pulse animate__infinite">üîç Open</button>
        <div id="receiveBox" class="mt-5"></div>
      </div>

    </div>
  </div>

  <!-- Toast -->
  <div id="toast"></div>

  <script>
    // üîπ Firebase Config (replace with your real values)
    const firebaseConfig = {
      apiKey: "AIzaSyXXXXXXX",
      authDomain: "sender-d6c0a.firebaseapp.com",
      databaseURL: "https://sender-d6c0a-default-rtdb.firebaseio.com",
      projectId: "sender-d6c0a",
      storageBucket: "sender-d6c0a.appspot.com",
      messagingSenderId: "19479079444",
      appId: "1:19479079444:web:abcdefg123456",
      measurementId: "G-XXXXXXX"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // üîπ Toast function
    function showToast(message) {
      const toast = document.getElementById("toast");
      toast.innerHTML = message;
      toast.style.display = "block";
      setTimeout(() => { toast.style.display = "none"; }, 3000);
    }

    // üîπ Random ID Generator
    function generateId(length = 6) {
      const chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";
      let result = "";
      for (let i = 0; i < length; i++) {
        result += chars.charAt(Math.floor(Math.random() * chars.length));
      }
      return result;
    }

    // üîπ Send Data
    function sendData() {
      let id = document.getElementById("senderId").value.trim();
      const file = document.getElementById("fileInput").files[0];
      const statusBox = document.getElementById("sendStatus");

      if (!file) {
        alert("‚ö†Ô∏è Please choose a file!");
        return;
      }
      if (!id) { id = generateId(); }

      statusBox.innerHTML = "‚è≥ Uploading file...";

      const reader = new FileReader();
      reader.onload = function(e) {
        const base64Data = e.target.result;
        db.ref("files/" + id).set({
          name: file.name,
          data: base64Data,
          time: new Date().toLocaleString()
        }).then(() => {
          statusBox.innerHTML = `‚úÖ File <b>${file.name}</b> sent successfully with ID: <b>${id}</b>`;
          showToast("üöÄ File Sent Successfully! ID: " + id);
        }).catch(err => {
          statusBox.innerHTML = "‚ùå Error: " + err.message;
        });
      };
      reader.readAsDataURL(file);
    }

    // üîπ Receive Data
    function receiveData() {
      const id = document.getElementById("receiverId").value.trim();
      if (!id) {
        alert("‚ö†Ô∏è Please enter an ID to receive data!");
        return;
      }

      const box = document.getElementById("receiveBox");
      box.innerHTML = "‚è≥ Fetching data...";

      db.ref("files/" + id).on("value", snapshot => {
        const data = snapshot.val();
        if (data) {
          box.innerHTML = `
            <div class="p-4 bg-white/90 rounded-xl shadow animate__animated animate__fadeInUp">
              <p class="text-gray-800 mb-2">üìÑ File: <b>${data.name}</b></p>
              <p class="text-sm text-gray-600 mb-3">‚è± Sent: ${data.time}</p>
              <a href="${data.data}" download="${data.name}" 
                onclick="showToast('üì• File Downloaded Successfully!')" 
                class="glow-btn bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg inline-block">‚¨á Download</a>
            </div>
          `;
        } else {
          box.innerHTML = "<p class='text-red-600 font-semibold animate__animated animate__shakeX'>‚ùå No file found for this ID</p>";
        }
      });
    }
  </script>

</body>
</html>
